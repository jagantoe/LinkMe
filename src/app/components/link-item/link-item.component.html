<div class="bg-white rounded-lg shadow-md p-4 sm:p-5 transition-all hover:translate-y-[-3px] hover:shadow-lg">
    @if (isEditing()) {
        <!-- Edit Link Form -->
        <app-link-form formTitle="Edit Link" [initialData]="link()" (formSubmit)="saveEditedLink($event)"
            (formCancel)="cancelEdit()" />
    } @else {
        <!-- Link Display -->
        <div class="flex justify-between items-start mb-3">
            <h3 class="text-base sm:text-lg font-medium text-gray-900 m-0 break-words max-w-[80%]"
                [title]="link().name">
                {{ link().name }}
            </h3>
            <div class="flex">
                <button
                    class="w-8 h-8 rounded-md bg-blue-50 border-none text-sm text-blue-500 flex items-center justify-center ml-2 flex-shrink-0 hover:bg-blue-100"
                    (click)="startEdit()" title="Edit link">
                    <i class="pi pi-pencil"></i>
                </button>
                <button
                    class="w-8 h-8 rounded-md bg-red-50 border-none text-sm text-red-500 flex items-center justify-center ml-2 flex-shrink-0 hover:bg-red-100"
                    (click)="deleteLink()" title="Delete link">
                    <i class="pi pi-trash"></i>
                </button>
            </div>
        </div>

        <div class="flex flex-col sm:flex-row sm:items-center mb-4 bg-gray-50 rounded p-2">
            <a [href]="link().url" target="_blank"
                class="flex-1 text-sm text-blue-400 no-underline overflow-hidden text-ellipsis hover:underline"
                [title]="link().url">
                {{ link().url }}
            </a>
            <!-- Copy button - desktop view -->
            <button
                class="hidden sm:block bg-transparent border border-gray-300 rounded px-2.5 py-1.5 text-xs text-gray-700 cursor-pointer sm:ml-2 flex-shrink-0 hover:bg-gray-100 sm:w-auto"
                #copyBtnDesktop (click)="copyToClipboard(link().url, copyBtnDesktop)" title="Copy link to clipboard">
                Copy
            </button>
            <!-- Copy button - mobile view -->
            <button
                class="sm:hidden bg-blue-400 text-white rounded-md px-3 py-2 text-sm font-medium cursor-pointer mt-2 flex items-center justify-center w-full"
                #copyBtnMobile (click)="copyToClipboard(link().url, copyBtnMobile)" title="Copy link to clipboard">
                <i class="pi pi-copy mr-2"></i> Copy URL
            </button>
        </div>
        <div class="flex flex-wrap gap-2 mt-2 min-h-[2rem]">
            @for (tag of link().tags; track tag) {
                <span [style.backgroundColor]="settings().defaultTagColor + '15'"
                    [style.color]="settings().defaultTagColor"
                    class="py-1 sm:py-1.5 px-2 sm:px-2.5 rounded">{{ tag }}</span>
            }
        </div>

        @if (showMatchType() && matchType() !== 'name') {
            <div class="mt-3 text-xs text-gray-400 italic">
                Matched by {{ matchType() }}
            </div>
        }
    }
</div>
